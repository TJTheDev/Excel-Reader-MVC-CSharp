@model System.Data.DataTable
@using System.Data

<h1>Excel Viewer</h1>

<div class="table-container">
    @if (Model != null && Model.Rows.Count > 0)
    {
        <p>The table for your Excel document is below.</p>

        <table>
            <thead>
                <tr>
                    @foreach (DataColumn column in Model.Columns)
                    {
                        <th>@column.ColumnName</th> <!-- Display the column names in the table header -->
                    }
                </tr>
            </thead>
            <tbody>
                @foreach (DataRow row in Model.Rows)
                {
                    <tr>
                        @foreach (var item in row.ItemArray)
                        {
                            <td>@item.ToString()</td> <!-- Display the cell values in the table body -->
                        }
                    </tr>
                }
                <tr id="newRowTemplate" style="display: none;">
                    @foreach (DataColumn column in Model.Columns)
                    {
                        <td>
                            <input type="text" name="@column.ColumnName" /> <!-- Create input fields for each column -->
                        </td>
                    }
                </tr>
            </tbody>
        </table>

        <div class="table-buttons">
            <button type="button" onclick="addLine()">Add Line</button>
            <button type="button" onclick="removeLine()">Remove Line</button>
        </div>
    }
</div>

@section Scripts {
    <script>
        function addLine() {
            var newRow = document.getElementById("newRowTemplate").cloneNode(true);
            newRow.removeAttribute("id");
            newRow.style.display = "table-row";

            var tableBody = document.querySelector("table tbody");
            tableBody.appendChild(newRow);

            // Clear the input fields in the new row
            var inputFields = newRow.getElementsByTagName("input");
            for (var i = 0; i < inputFields.length; i++) {
                inputFields[i].value = "";
            }
        }

        function removeLine() {
            var tableBody = document.querySelector("table tbody");
            var rows = tableBody.querySelectorAll("tr");

            if (rows.length > 0) {
                tableBody.removeChild(rows[rows.length - 1]);
            }
        }
    </script>
}