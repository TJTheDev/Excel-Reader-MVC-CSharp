@model DataTable
@using System.Data


<h2>Uploaded Excel Spreadsheet</h2>

<form asp-controller="Home" asp-action="Upload" method="post" enctype="multipart/form-data">
    <input type="file" name="file" />
    <input type="submit" value="Upload" />
</form>

@if (Model != null && Model.Rows.Count > 0)
{
    <table>
        <thead>
            @foreach (DataColumn column in Model.Columns)
            {
            <th>@column.ColumnName</th>
            }
        </thead>
        <tbody>
            @foreach (DataRow row in Model.Rows)
            {
                <tr>
                    @foreach (var item in row.ItemArray)
                    {
                        <td>@item</td>
                    }
                </tr>
            }
        </tbody>
    </table>

    <button type="button" onclick="addLine()">Add Line</button>
    <button type="button" onclick="removeLine()">Remove Line</button>
}

@section Scripts {
    <script>
        function addLine() {
            var newRow = document.createElement("tr");
            var table = document.querySelector("table tbody");

            // Modify the below code to add the desired number of columns
            for (var i = 0; i < 5; i++) {
                var newCell = document.createElement("td");
                newCell.textContent = "New Value";
                newRow.appendChild(newCell);
            }

            table.appendChild(newRow);
        }

        function removeLine() {
            var table = document.querySelector("table tbody");
            var rows = table.querySelectorAll("tr");

            if (rows.length > 0) {
                table.removeChild(rows[rows.length - 1]);
            }
        }
    </script>
}
